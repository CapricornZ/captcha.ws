#set( $ContextPath = ${request.contextPath} )

<link rel="stylesheet" href="${ContextPath}/css/bootstrap.css" >
<link rel="stylesheet" type="text/css" href="${ContextPath}/css/jquery.datetimepicker.css"/>

<script type="text/javascript" src="${ContextPath}/js/jquery/jquery-1.11.2.min.js"></script>

<script type="text/javascript">
	$(function(){
	
		$.get("../client/list.do", function(result){
			for(var i=0; i<result.length; i++){
				var option = $("<option>").val(result[i].ip).text(result[i].ip);
				$('#client').append(option);
			}
  		});
  		
  		$("button[toggle='DEL']").click(function(){

  			var configID = $(this).parent().parent().attr("config");
  			var endPoint = "${ContextPath}/command/config/delete.do?config=" + configID;
  			$.ajax({
  				url  : endPoint,
  				type : 'DELETE',
  				cache: false,
				contentType: 'application/json; charset=utf-8',
				success: function(json) {
					alert("SUCCESS");
					console.log(" reponse :"+ json);
                }
  			});
  		});
  		
  		$("#OK").click(function(){
  			
  			var endPoint = "${ContextPath}/command/config/new.do?client=" + $("#client").val();
  			var reqParam = {
  				no:$("#noInput").val(),
  				passwd:$("#passwdInput").val(),
  				pid:$("#pidInput").val(),
  				pname:$("#puserInput").val()
  			};
  			$.ajax({
  				url:endPoint,
  				type:'POST',
  				cache:false,
				data:JSON.stringify(reqParam),
				contentType: 'application/json; charset=utf-8',
				success: function(json) {
					alert("SUCCESS");
					console.log(" reponse :"+ json);
                }
  			});
  		});
	});
</script>

<div class="container-fluid">
	<div class="row">
		<div class="col-md-8">
			<table class="table table-striped .table-bordered">
				<tr>
					<td></td>
					<td>投标号</td>
					<td>密码</td>
					<td>身份证号</td>
					<td>姓名</td>
					<td></td>
				</tr>
				#foreach(${config} in ${configs})
				<tr config="${config.no}">
					<td>×</td>
					<td>${config.no}</td>
					<td>${config.passwd}</td>
					<td>${config.pid}</td>
					<td>${config.pname}</td>
					<td>
						<button class="btn btn-primary" type="submit" toggle="DEL" >删除</button>
					</td>
				</tr>
				#end
			</table>
		</div>
		<div class="col-md-4">
			<form class="form-horizontal" onsubmit="return false;">
				<fieldset>
					<legend>创建配置</legend>
					<div class="form-group">
						<label class="col-sm-2 control-label" for="noInput">投标号</label>
						<div class="col-sm-10">
							<div class="input-group">
								<span class="input-group-addon">#</span>
								<input id="noInput" class="form-control" style="width:200px;height:30px;" type="text"  placeholder="投标号"></input>
							</div>
						</div>
					</div>
					<div class="form-group">
						<label class="col-sm-2 control-label" for="passwdInput">密码</label>
						<div class="col-sm-10">
							<div class="input-group">
								<span class="input-group-addon">#</span>
								<input id="passwdInput" class="form-control" style="width:200px;height:30px;" type="text" placeholder="标书密码"></input>
							</div>
						</div>
					</div>
					<div class="form-group">
						<label class="col-sm-2 control-label" for="pidInput">身份证</label>
						<div class="col-sm-2">
							<div class="input-group">
								<span class="input-group-addon">#</span>
								<input id="pidInput" class="form-control" style="width:200px;height:30px;" type="text" placeholder="身份证号码"></input>
							</div>
						</div>
					</div>
					<div class="form-group">
						<label class="col-sm-2 control-label" for="puserInput">姓名</label>
						<div class="col-sm-2">
							<div class="input-group">
								<span class="input-group-addon">#</span>
								<input id="puserInput" class="form-control" style="width:200px;height:30px;" type="text" placeholder="用户姓名"></input>
							</div>
						</div>
					</div>
					<div class="form-group">
						<label class="col-sm-2 control-label" for="client">CLIENTs</label>
						<div class="col-sm-2">
							<select id="client" class="form-control" style="width:200px;height:40px;">
								<option value="">空</option>
							</select>
						</div>
					</div>
					<div class="col-sm-offset-2 col-sm-10">
						<button class="btn btn-primary" type="submit" id="OK">确定</button>
						<button class="btn">取消</button>
					</div>
				</fieldset>
			</form>
		</div>
	</div><!-- row -->
</div><!--container-fluid-->
